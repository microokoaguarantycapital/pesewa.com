<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Borrow Money - Pesewa.com</title>
    <link rel="stylesheet" href="../assets/css/main.css">
    <link rel="stylesheet" href="../assets/css/forms.css">
    <link rel="stylesheet" href="../assets/css/tables.css">
    <link rel="stylesheet" href="../assets/css/animations.css">
    <link rel="manifest" href="../manifest.json">
    <link rel="icon" type="image/svg+xml" href="../assets/images/logo.svg">
</head>
<body class="page-borrowing">
    <header class="header">
        <nav class="navbar">
            <div class="nav-brand">
                <a href="../index.html">
                    <img src="../assets/images/logo.svg" alt="Pesewa Logo" class="logo">
                    <span class="brand-name">Pesewa.com</span>
                </a>
            </div>
            <ul class="nav-menu">
                <li><a href="../index.html">Home</a></li>
                <li><a href="./dashboard/borrower-dashboard.html">Dashboard</a></li>
                <li><a href="./lending.html">Lend</a></li>
                <li class="active"><a href="./borrowing.html">Borrow</a></li>
                <li><a href="./groups.html">Groups</a></li>
                <li><a href="./subscriptions.html">Subscription</a></li>
            </ul>
            <div class="nav-actions">
                <a href="./dashboard/borrower-dashboard.html" class="btn btn-outline">My Account</a>
                <button id="logoutBtn" class="btn btn-logout">Logout</button>
            </div>
        </nav>
    </header>

    <main class="main-container">
        <div class="page-header">
            <h1>Borrow for Urgent Needs</h1>
            <p>Request loans from trusted lenders in your groups. Get funds in under 10 minutes for specific emergency needs.</p>
        </div>

        <div class="content-grid">
            <!-- Borrowing Form -->
            <section class="card borrowing-form-card">
                <h2>New Loan Request</h2>
                <form id="borrowingForm">
                    <div class="form-group">
                        <label for="borrowCategory">What do you need?</label>
                        <div class="category-grid">
                            <div class="category-card" data-category="transport">
                                <div class="category-icon">üöå</div>
                                <span>Transport</span>
                            </div>
                            <div class="category-card" data-category="data">
                                <div class="category-icon">üì±</div>
                                <span>Data & Airtime</span>
                            </div>
                            <div class="category-card" data-category="gas">
                                <div class="category-icon">üî•</div>
                                <span>Cooking Gas</span>
                            </div>
                            <div class="category-card" data-category="food">
                                <div class="category-icon">üç≤</div>
                                <span>Food</span>
                            </div>
                            <div class="category-card" data-category="water">
                                <div class="category-icon">üíß</div>
                                <span>Water Bill</span>
                            </div>
                            <div class="category-card" data-category="fuel">
                                <div class="category-icon">‚õΩ</div>
                                <span>Fuel</span>
                            </div>
                            <div class="category-card" data-category="repair">
                                <div class="category-icon">üõ†Ô∏è</div>
                                <span>Repair</span>
                            </div>
                            <div class="category-card" data-category="medicine">
                                <div class="category-icon">üíä</div>
                                <span>Medicine</span>
                            </div>
                            <div class="category-card" data-category="electricity">
                                <div class="category-icon">üí°</div>
                                <span>Electricity</span>
                            </div>
                            <div class="category-card" data-category="school">
                                <div class="category-icon">üéì</div>
                                <span>School Fees</span>
                            </div>
                            <div class="category-card" data-category="tv">
                                <div class="category-icon">üì∫</div>
                                <span>TV Subscription</span>
                            </div>
                        </div>
                        <input type="hidden" id="selectedCategory" name="category" required>
                    </div>

                    <div class="form-group">
                        <label for="loanAmount">How much do you need? (‚Çµ)</label>
                        <div class="amount-input">
                            <input type="number" id="loanAmount" min="50" max="20000" value="1000" class="form-control" required>
                            <div class="amount-slider">
                                <input type="range" id="loanAmountSlider" min="50" max="20000" value="1000" class="slider">
                                <div class="slider-labels">
                                    <span>‚Çµ50</span>
                                    <span id="amountDisplay">‚Çµ1,000</span>
                                    <span>‚Çµ20,000</span>
                                </div>
                            </div>
                            <small>Maximum amount depends on your tier and group limits</small>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="selectGroup">Select Group</label>
                        <select id="selectGroup" class="form-select" required>
                            <option value="">Choose a group</option>
                            <option value="family">Family Trust Group (3 lenders available)</option>
                            <option value="church">Church Group (5 lenders available)</option>
                            <option value="business">Business Network (2 lenders available)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="selectLender">Preferred Lender (Optional)</label>
                        <select id="selectLender" class="form-select">
                            <option value="">Any available lender</option>
                            <option value="sarah">Sarah Lender (‚≠ê4.8, 97% approval)</option>
                            <option value="mike">Mike Lender (‚≠ê4.5, 95% approval)</option>
                            <option value="anna">Anna Lender (‚≠ê4.9, 99% approval)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="urgency">Urgency Level</label>
                        <div class="urgency-options">
                            <label class="radio-label">
                                <input type="radio" name="urgency" value="normal" checked>
                                <span class="radio-text">Normal (Within 24 hours)</span>
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="urgency" value="urgent">
                                <span class="radio-text">Urgent (Within 2 hours)</span>
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="urgency" value="emergency">
                                <span class="radio-text">Emergency (Within 10 minutes)</span>
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="loanPurpose">Purpose of Loan (Brief Description)</label>
                        <textarea id="loanPurpose" class="form-control" rows="3" placeholder="e.g., Need transport to attend job interview tomorrow" maxlength="200"></textarea>
                        <small class="char-count"><span id="charCount">0</span>/200 characters</small>
                    </div>

                    <div class="form-info">
                        <h4>Loan Terms</h4>
                        <ul>
                            <li>7-day repayment period</li>
                            <li>10% weekly interest (‚Çµ<span id="interestPreview">100</span>)</li>
                            <li>Daily partial payments allowed</li>
                            <li>5% daily penalty after 7 days</li>
                            <li>Default after 60 days leads to blacklisting</li>
                        </ul>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary btn-large">Submit Loan Request</button>
                        <button type="button" class="btn btn-secondary" id="calculateBtn">Calculate Repayment</button>
                    </div>
                </form>
            </section>

            <!-- Active Requests -->
            <section class="card active-requests-card">
                <h2>Your Active Loan Requests</h2>
                <div class="table-responsive">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Request ID</th>
                                <th>Category</th>
                                <th>Amount</th>
                                <th>Group</th>
                                <th>Date</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>#REQ-001</td>
                                <td>üöå Transport</td>
                                <td>‚Çµ1,200</td>
                                <td>Family Trust</td>
                                <td>2024-03-20</td>
                                <td><span class="status approved">Approved</span></td>
                                <td>
                                    <button class="btn btn-sm btn-success">View</button>
                                    <button class="btn btn-sm btn-alert">Cancel</button>
                                </td>
                            </tr>
                            <tr>
                                <td>#REQ-002</td>
                                <td>üì± Data</td>
                                <td>‚Çµ500</td>
                                <td>Church Group</td>
                                <td>2024-03-22</td>
                                <td><span class="status pending">Pending</span></td>
                                <td>
                                    <button class="btn btn-sm btn-success">View</button>
                                    <button class="btn btn-sm btn-alert">Cancel</button>
                                </td>
                            </tr>
                            <tr>
                                <td>#REQ-003</td>
                                <td>üç≤ Food</td>
                                <td>‚Çµ800</td>
                                <td>Business Network</td>
                                <td>2024-03-23</td>
                                <td><span class="status rejected">Rejected</span></td>
                                <td>
                                    <button class="btn btn-sm btn-secondary">Reapply</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Available Lenders -->
            <section class="card lenders-card">
                <h2>Available Lenders in Your Groups</h2>
                <div class="lenders-grid">
                    <div class="lender-card">
                        <div class="lender-header">
                            <div class="lender-avatar">S</div>
                            <div class="lender-info">
                                <h4>Sarah Lender</h4>
                                <p class="lender-rating">‚≠ê 4.8/5.0</p>
                            </div>
                        </div>
                        <div class="lender-details">
                            <p><strong>Categories:</strong> All categories</p>
                            <p><strong>Max Amount:</strong> ‚Çµ20,000</p>
                            <p><strong>Approval Rate:</strong> 97%</p>
                            <p><strong>Response Time:</strong> < 10 mins</p>
                        </div>
                        <button class="btn btn-primary btn-small">Request Loan</button>
                    </div>

                    <div class="lender-card">
                        <div class="lender-header">
                            <div class="lender-avatar">M</div>
                            <div class="lender-info">
                                <h4>Mike Lender</h4>
                                <p class="lender-rating">‚≠ê 4.5/5.0</p>
                            </div>
                        </div>
                        <div class="lender-details">
                            <p><strong>Categories:</strong> Food, Transport, Medicine</p>
                            <p><strong>Max Amount:</strong> ‚Çµ5,000</p>
                            <p><strong>Approval Rate:</strong> 95%</p>
                            <p><strong>Response Time:</strong> < 30 mins</p>
                        </div>
                        <button class="btn btn-primary btn-small">Request Loan</button>
                    </div>

                    <div class="lender-card">
                        <div class="lender-header">
                            <div class="lender-avatar">A</div>
                            <div class="lender-info">
                                <h4>Anna Lender</h4>
                                <p class="lender-rating">‚≠ê 4.9/5.0</p>
                            </div>
                        </div>
                        <div class="lender-details">
                            <p><strong>Categories:</strong> School Fees, Electricity, Water</p>
                            <p><strong>Max Amount:</strong> ‚Çµ15,000</p>
                            <p><strong>Approval Rate:</strong> 99%</p>
                            <p><strong>Response Time:</strong> < 1 hour</p>
                        </div>
                        <button class="btn btn-primary btn-small">Request Loan</button>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h3>Pesewa.com</h3>
                <p>Emergency micro-lending in trusted circles across Africa.</p>
            </div>
            <div class="footer-section">
                <h3>Quick Links</h3>
                <ul>
                    <li><a href="./about.html">About Us</a></li>
                    <li><a href="./contact.html">Contact</a></li>
                    <li><a href="./qa.html">Q&A</a></li>
                    <li><a href="./subscriptions.html">Subscriptions</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Legal</h3>
                <ul>
                    <li><a href="#">Privacy Policy</a></li>
                    <li><a href="#">Terms of Service</a></li>
                    <li><a href="#">Disclaimer</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2024 Pesewa.com. All rights reserved.</p>
        </div>
    </footer>

    <script src="../assets/js/utils.js"></script>
    <script src="../assets/js/borrowing.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Category selection
            const categoryCards = document.querySelectorAll('.category-card');
            const selectedCategoryInput = document.getElementById('selectedCategory');

            categoryCards.forEach(card => {
                card.addEventListener('click', function() {
                    categoryCards.forEach(c => c.classList.remove('selected'));
                    this.classList.add('selected');
                    selectedCategoryInput.value = this.dataset.category;
                });
            });

            // Amount slider sync
            const loanAmount = document.getElementById('loanAmount');
            const loanAmountSlider = document.getElementById('loanAmountSlider');
            const amountDisplay = document.getElementById('amountDisplay');
            const interestPreview = document.getElementById('interestPreview');

            function updateAmount() {
                const amount = parseInt(loanAmount.value) || 1000;
                const interest = amount * 0.10;
                
                loanAmountSlider.value = amount;
                amountDisplay.textContent = `‚Çµ${amount.toLocaleString()}`;
                interestPreview.textContent = interest.toLocaleString(undefined, {minimumFractionDigits: 2});
            }

            loanAmount.addEventListener('input', updateAmount);
            loanAmountSlider.addEventListener('input', function() {
                loanAmount.value = this.value;
                updateAmount();
            });
            updateAmount();

            // Character count
            const loanPurpose = document.getElementById('loanPurpose');
            const charCount = document.getElementById('charCount');

            loanPurpose.addEventListener('input', function() {
                charCount.textContent = this.value.length;
            });

            // Calculate repayment
            document.getElementById('calculateBtn').addEventListener('click', function() {
                const amount = parseFloat(loanAmount.value) || 0;
                const interest = amount * 0.10;
                const total = amount + interest;
                const daily = total / 7;

                alert(`Repayment Calculation:\n\nPrincipal: ‚Çµ${amount.toLocaleString(undefined, {minimumFractionDigits: 2})}\nInterest (10%): ‚Çµ${interest.toLocaleString(undefined, {minimumFractionDigits: 2})}\nTotal Due: ‚Çµ${total.toLocaleString(undefined, {minimumFractionDigits: 2})}\nDaily Payment (7 days): ‚Çµ${daily.toLocaleString(undefined, {minimumFractionDigits: 2})}`);
            });

            // Form submission
            document.getElementById('borrowingForm').addEventListener('submit', function(e) {
                e.preventDefault();
                if (!selectedCategoryInput.value) {
                    alert('Please select a loan category.');
                    return;
                }
                alert('Loan request submitted successfully! Lenders will be notified.');
                this.reset();
                categoryCards.forEach(c => c.classList.remove('selected'));
                selectedCategoryInput.value = '';
            });

            // Logout
            document.getElementById('logoutBtn').addEventListener('click', function() {
                if (confirm('Are you sure you want to logout?')) {
                    window.location.href = '../index.html';
                }
            });
        });
    </script>
</body>
</html>